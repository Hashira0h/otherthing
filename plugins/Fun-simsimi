import fetch from 'node-fetch';

let handler = async (m, { conn, text, usedPrefix, command }) => {
  const name = conn.getName(m.sender);
  if (!text) {
    throw `Ø§Ù‡Ù„Ø§ *${name}*, Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ÙŠ ØŸ Ø§Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø§ÙƒØªØ¨ Ù‡Ø°Ø§ : *${usedPrefix + command}* (Ø±Ø³Ø§Ù„ØªÙƒ)\nğŸ“Œ Ù…Ø«Ø§Ù„: *${usedPrefix + command}* Ø§Ù‡Ù„Ø§ Ø¨ÙˆØª`;
  }
  
  m.react('ğŸ—£ï¸');
  
  const options = {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: `text=${encodeURIComponent(text)}&lc=en&key=`
  };

  const res = await fetch('https://api.simsimi.vn/v1/simtalk', options);
  const json = await res.json();
  
  if (json.status === '200') {
    const reply = json.message;
    m.reply(reply);
  } else {
    throw json;
  }
};

handler.help = ['bot'];
handler.tags = ['fun'];
handler.command = ['Ù…ÙŠÙƒØ§Ø³Ø§'];

export default handler;
